"use strict";function debounce(e,t,r=!1){let s=null;return function(){const i=r&&!s,a=()=>e.apply(this,arguments);clearTimeout(s),s=setTimeout(a,t),i&&a()}}const jetSmartFiltersSettinsMixin={data:function(){return{data:window.jetSmartFiltersSettingsConfig.data,settings:window.jetSmartFiltersSettingsConfig.settings,preparedOptions:{},savingStatus:!1,ajaxSaveHandler:null}},watch:{settings:{handler(e){const t={};for(const r in e)t[r]=e[r];this.preparedOptions=t,this.saveOptions()},deep:!0}},methods:{saveOptions:debounce(function(){var e=this;e.savingStatus=!0,e.ajaxSaveHandler=jQuery.ajax({type:"POST",url:window.jetSmartFiltersSettingsConfig.settingsApiUrl,dataType:"json",data:e.preparedOptions,beforeSend:function(t,r){t.setRequestHeader("X-WP-Nonce",window.jetSmartFiltersSettingsConfig.nonce),null!==e.ajaxSaveHandler&&e.ajaxSaveHandler.abort()},success:function(t,r,s){e.savingStatus=!1,"success"===t.status&&e.$CXNotice.add({message:t.message,type:"success",duration:3e3}),"error"===t.status&&e.$CXNotice.add({message:t.message,type:"error",duration:3e3})}})},300),repeaterAddItem:function(e,t){t.push(e)},repeaterDeleteItem:function(e,t){t.splice(e,1)},updateAlias(e,t,r){const s=this.settings.url_aliases[t];s&&s[r]!==e&&(s[r]=e)},onAliasInputEvent(e,t,r){("keypress"===e.type&&13===e.keyCode||"blur"===e.type)&&this.updateAlias(e.target.value,t,r)},updateProviderPreloaderCSS(){const{use_bg:e,size:t,color:r,border_radius:s,bg_color:i,padding:a}=this.settings.provider_preloader_styles;let n=".jsf_provider-preloader{";n+=`font-size:${t}px;`,n+=`color:${r};`,e&&(n+=`border-radius:${s}px;`,n+=`background:${i};`,n+=`padding:${a.top}px ${a.right}px ${a.bottom}px ${a.left}px;`,n+="box-shadow:1px 2px 8px rgba(35,40,45,.2);"),n+="}",this.settings.provider_preloader_css=n},changeProviderPreloaderTemplate(e){const t=jQuery(".provider-preloader-preview__container");t.addClass("provider-preloader-template-loading"),jQuery.ajax({url:window.jetSmartFiltersSettingsConfig.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_smart_filters_get_provider_preloader_template",type:e}}).done(e=>{const r=e.data;r&&r.template&&(t.removeClass("provider-preloader-template-loading"),t.html(r.template))})}}};Vue.component("jet-smart-filters-general-settings",{template:"#jet-dashboard-jet-smart-filters-general-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-indexer-settings",{template:"#jet-dashboard-jet-smart-filters-indexer-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-url-structure-settings",{template:"#jet-dashboard-jet-smart-filters-url-structure-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-ajax-request-type",{template:"#jet-dashboard-jet-smart-filters-ajax-request-type",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-provider-preloader",{template:"#jet-dashboard-jet-smart-filters-provider-preloader",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-accessibility-settings",{template:"#jet-dashboard-jet-smart-filters-accessibility-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jsf-url-aliases-example",{template:"#jet-smart-filters-url-aliases-example",props:{value:{type:String,default:""},aliases:{type:Array,default:()=>[]},urlPrefix:{type:String,default:"http://demo.org/"},defaultUrl:{type:String,default:""}},data:function(){return{url:this.value,directOpened:!1,reverseOpened:!1,isUrlEdite:!1}},computed:{directUrl(){return this.urlAliasesTransform(this.url)},reverseUrl(){return this.urlAliasesTransform(this.directUrl,!0)},directTransformations(){return this.urlAliasesTransformations(this.url)},reverseTransformations(){return this.urlAliasesTransformations(this.directUrl,!0)},isUrl(){return!!this.url&&/[\/|\?|\&]jsf[\/|=]/.test(this.url)},isNotDefaultUrl(){return this.defaultUrl&&this.url!==this.defaultUrl},isMatches(){return this.directTransformations.length>0||this.reverseTransformations.length>0}},watch:{value(e){this.url=e}},methods:{urlAliasesTransformations(e,t=!1){const r=[];let s=e,i=0;return this.aliases.forEach(a=>{if(i++,!a.needle||!a.replacement)return;const n=e.indexOf(t?a.replacement:a.needle);if(n>-1){const l=n+(t?a.needle.length:a.replacement.length);e=t?e.replace(a.replacement,a.needle):e.replace(a.needle,a.replacement),s=e.slice(0,n)+'<span class="highlight">'+e.slice(n,l)+"</span>"+e.slice(l),r.push({url:e,html:s,replacement:{from:t?a.replacement:a.needle,to:t?a.needle:a.replacement},index:i})}}),r},urlAliasesTransform(e,t=!1){return this.aliases.forEach(r=>{r.needle&&r.replacement&&(e=t?e.replace(r.replacement,r.needle):e.replace(r.needle,r.replacement))}),e},onUrlInput(e){},onUrlEditClick(){this.isUrlEdite=!0,this.$nextTick(()=>this.$refs.urlInput.focus())},onUrlEditRestoreClick(){this.isNotDefaultUrl&&this.$emit("input",this.defaultUrl)},onUrlEditConfirmClick(){const e=jQuery(this.$el).find(".url-aliases-example-string-editor-input").val();e!==this.value&&this.$emit("input",e),this.isUrlEdite=!1},onUrlEditCancelClick(){this.url=this.value,this.isUrlEdite=!1},onDirectClick(){this.directOpened=!this.directOpened},onReverseClick(){this.reverseOpened=!this.reverseOpened}}}),Vue.component("v-style",{render:function(e){return e("style",this.$slots.default)}});