!function(e){"use strict";var t=window.JetSmartFiltersAdminData||!1,o={init:function(){var t=o;t.currentFilterType=e("#_filter_type").val(),t.$querySettingsBox=e("#query-settings"),t.$notesBox=e("#filter-notes"),t.$dateFormatsBox=e("#filter-date-formats"),t.switchQueryVar(),t.toggleMetaBoxes(),e("#_filter_type").attr("required","required"),e("#jet-smart-filters-admin-mode-switcher").on("click",t.adminModeSwitch),e("#jet-smart-filters-indexer-button").on("click",t.reindexFilters),e(document).ready(()=>{t.updateExcludeInclude(),t.updateColorImageOptions()}).on("change.JetSmartFiltersAdmin","#_filter_type",t.switchFilterType).on("change.JetSmartFiltersAdmin","#_filter_type",t.switchQueryVar).on("change.JetSmartFiltersAdmin","#_data_source",t.switchQueryVar).on("change.JetSmartFiltersAdmin","#_date_source",t.switchQueryVar).on("change.JetSmartFiltersAdmin","#_s_by",t.switchQueryVar).on("change.JetSmartFiltersAdmin","#_data_source",t.updateExcludeInclude).on("change.JetSmartFiltersAdmin","#_source_post_type",t.updateExcludeInclude).on("change.JetSmartFiltersAdmin","#_source_taxonomy",t.updateExcludeInclude).on("change.JetSmartFiltersAdmin","#_data_source",t.updateColorImageOptions).on("cx-control-init",t.updateColorImageOptions).on("change.JetSmartFiltersAdmin","#_source_post_type",t.initColorImageOptions).on("change.JetSmartFiltersAdmin","#_source_taxonomy",t.initColorImageOptions).on("change.JetSmartFiltersAdmin","#_color_image_type",t.switchColorImageControls),e(window).on("cx-switcher-change",t.switchQueryVar)},adminModeSwitch:function(){var o=e(this),a=o.data("loading-text");o.addClass("loading"),o.html(a),e.ajax({type:"POST",url:t.urls.endpoints.AdminModeSwitch,data:{mode:"modern"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",t.nonce)},success:function(e){window.location=t.urls.admin+"admin.php?page=jet-smart-filters"}})},reindexFilters:function(){var o=e(this),a=o.data("default-text"),n=o.data("loading-text");o.addClass("loading"),o.html(n),e.ajax({url:t.urls.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_smart_filters_admin_indexer",nonce:t.nonce}}).done(function(){o.removeClass("loading"),o.html(a)})},updateColorImageOptions:function(e,t){o.switchColorImageControls(),o.initColorImageOptions(t)},updateExcludeInclude:function(){var o=e("#_source_taxonomy option:selected").val(),a=e("#_source_post_type option:selected").val(),n=e("#_data_source option:selected").val();0!==e("#_data_exclude_include").length&&e.ajax({url:t.urls.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_smart_filters_admin",taxonomy:o,post_type:a}}).done(function(o){var a=e("#_data_exclude_include");switch(n){case"taxonomies":a.html(o.terms);break;case"posts":a.html(o.posts)}a.val(t.dataExcludeInclude),a.trigger("change")})},switchColorImageControls:function(){var t=e("#_filter_type option:selected").val(),o=e("#_color_image_type option:selected").val(),a=e("#_data_source option:selected").val(),n=e(".jet-smart-filters-color-image");"color-image"===t&&(n.attr("data-type",o),n.attr("data-source",a))},initColorImageOptions:function(a){var n=e("#_source_taxonomy option:selected").val(),r=e("#_filter_type option:selected").val(),i=e("#_source_post_type option:selected").val(),s=e("#_data_source option:selected").val(),c=e("#_show_empty_terms-true").prop("checked");"color-image"===r&&e.ajax({url:t.urls.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_smart_filters_admin",post_type:i,taxonomy:n,hide_empty:!c}}).done(function(t){var n=!1,r=e('.cx-ui-select[name*="selected_value"]');switch(a&&(r=e('.cx-ui-select[name*="selected_value"]',a.target),n=!0),s){case"taxonomies":r.each(function(){e(this).html(t.terms)});break;case"posts":r.each(function(){e(this).html(t.posts)})}n||o.setColorImageOptions()})},setColorImageOptions:function(){var o=t.dataColorImage,a=0;for(const t in o){const n=o[t];e('.cx-ui-select[name="_source_color_image_input[item-'+a+'][selected_value]"]').val(n.selected_value),a++}},switchQueryVar:function(t){var a=e("#_filter_type option:selected").val(),n=e("#_data_source option:selected").val(),r=e("#_data_source"),i=e("#_date_source option:selected").val(),s=e("#_s_by option:selected").val(),c=e("#_is_hierarchical-true").prop("checked"),l=e("#_is_custom_checkbox-true").prop("checked"),d=e('div[data-control-name="_query_var"]'),u=!1,m=e('div[data-control-name="_query_compare"]'),_=!0;"color-image"===a?(r.find('option[value="custom_fields"]').addClass("cx-control-hidden"),"custom_fields"===n&&r.val("").change()):r.find('option[value="custom_fields"]').removeClass("cx-control-hidden"),c||"alphabet"===a?u=!0:"search"===a?u="default"===s:["date-range","date-period"].includes(a)?u="date_query"===i:-1!==["checkboxes","select","radio","color-image"].indexOf(a)&&-1!==["taxonomies"].indexOf(n)&&(u=!0),e.each(["select","radio"],function(e,t){t!==a||l||(_=!1)}),u&&!d.hasClass("cx-control-hidden")&&d.addClass("cx-control-hidden").find('input[name="_query_var"]').removeAttr("required"),!u&&d.hasClass("cx-control-hidden")&&d.removeClass("cx-control-hidden").find('input[name="_query_var"]').attr("required","required"),u||_?m.addClass("cx-control-hidden"):m.removeClass("cx-control-hidden"),t&&"_show_empty_terms"===t.controlName&&o.initColorImageOptions()},switchFilterType:function(e){const t=e.target.value;o.currentFilterType=t,o.toggleMetaBoxes()},toggleMetaBoxes(){["date-range","date-period"].includes(o.currentFilterType)?o.$dateFormatsBox.show():o.$dateFormatsBox.hide(),"alphabet"===o.currentFilterType?(o.$querySettingsBox.hide(),o.$notesBox.hide()):(o.$querySettingsBox.show(),o.$notesBox.show())}};o.init()}(jQuery);