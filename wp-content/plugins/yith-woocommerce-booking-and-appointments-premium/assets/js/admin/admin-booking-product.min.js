jQuery(function(a){"use strict";bk.blockParamsNoLoader;var n=bk.blockParamsDisable,i={productData:a("#woocommerce-product-data"),productType:a("select#product-type"),bookingDurationUnit:a("select#_yith_booking_duration_unit"),minuteSelect:a("#_yith_booking_duration_minute_select"),bookingDuration:a("#_yith_booking_duration"),bookingDurationType:a("select#_yith_booking_duration_type"),peopleEnabled:a("#_yith_booking_has_persons"),peopleTypesEnabled:a("#_yith_booking_enable_person_types"),canBeCancelled:a("#_yith_booking_can_be_cancelled")},t=function(){var e=!1;return wcbk_admin.prod_type===i.productType.val()&&((e={duration:parseInt(i.bookingDuration.val(),10),durationUnit:i.bookingDurationUnit.val(),durationType:i.bookingDurationType.val(),canBeCancelled:"yes"===i.canBeCancelled.val(),peopleEnabled:"yes"===i.peopleEnabled.val(),peopleTypesEnabled:"yes"===i.peopleTypesEnabled.val()}).hasTime=["hour","minute"].includes(e.durationUnit),e.isCustomerOneDay="customer"===e.durationType&&1===e.duration&&"day"===e.durationUnit,e.isFixedAndTime="fixed"===e.durationType&&e.hasTime),e},o={enablePrefix:".bk_enable_if_",conditions:{customer_chooses_blocks:"customer_chooses_blocks",can_be_cancelled:"can_be_cancelled",customer_one_day:"customer_one_day",booking_has_persons:"booking_has_persons",day:"day",time:"time",fixed_and_time:"fixed_and_time",unit_is_month:"unit_is_month",unit_is_day:"unit_is_day",unit_is_hour:"unit_is_hour",unit_is_minute:"unit_is_minute",people_and_people_types:"people_and_people_types"},initialProductType:"simple",init:function(){o.initialProductType=i.productType.val(),i.minuteSelect.hide().on("change",function(){i.bookingDuration.val(a(this).val()).trigger("change")}),a(document).find("._tax_status_field").closest("div").addClass("show_if_"+wcbk_admin.prod_type),i.productType.on("change",function(){o.initialProductType!==wcbk_admin.prod_type&&wcbk_admin.prod_type===a(this).val()&&a("#_virtual").attr("checked","checked").trigger("change")}).trigger("change"),i.bookingDurationUnit.on("change",function(){var e=a(this).val(),t="hour"===e||"minute"===e,n="day"===e;"minute"===e?(i.bookingDuration.hide(),i.minuteSelect.show().trigger("change")):(i.minuteSelect.hide(),i.bookingDuration.show()),a(document).trigger("yith_wcbk_booking_product_duration_unit_changed",[{value:e,has_time:t,is_day:n}])}).trigger("change")},handleEnabledFields:function(e){var t=o;e&&(t.handle(t.conditions.customer_chooses_blocks,"customer"===e.durationType),t.handle(t.conditions.can_be_cancelled,e.canBeCancelled),t.handle(t.conditions.customer_one_day,e.isCustomerOneDay),t.handle(t.conditions.fixed_and_time,e.isFixedAndTime),t.handle(t.conditions.booking_has_persons,e.peopleEnabled),t.handle(t.conditions.booking_has_persons,e.peopleEnabled&&e.peopleTypesEnabled),t.handle(t.conditions.time,e.hasTime),t.handle(t.conditions.day,"day"===e.durationUnit),t.handle(t.conditions.unit_is_month,"month"===e.durationUnit),t.handle(t.conditions.unit_is_day,"day"===e.durationUnit),t.handle(t.conditions.unit_is_hour,"hour"===e.durationUnit),t.handle(t.conditions.unit_is_minute,"minute"===e.durationUnit))},handle:function(e,t){e=o.enablePrefix+e;t?a(e).unblock():a(e).block(n)}};o.init();var s={init:function(){i.productType.on("change",s.update),i.bookingDurationUnit.on("change",s.update),i.bookingDurationType.on("change",s.update),i.canBeCancelled.on("change",s.update),i.peopleEnabled.on("change",s.update),i.peopleTypesEnabled.on("change",s.update),a(document).on("change","#_yith_booking_duration_type, #_yith_booking_duration, #_yith_booking_duration_unit",s.update),s.update()},getClasses:function(e){var t=[];return e&&(t.push("bk_is_booking"),t.push("bk_duration_unit--"+e.durationUnit),t.push("bk_duration_type--"+e.durationType),e.hasTime&&t.push("bk_has_time"),e.canBeCancelled&&t.push("bk_can_be_cancelled"),e.isCustomerOneDay&&t.push("bk_is_customer_one_day"),e.isFixedAndTime&&t.push("bk_is_fixed_and_time"),e.peopleEnabled&&t.push("bk_has_people"),e.peopleEnabled&&e.peopleTypesEnabled&&t.push("bk_has_people_and_people_types")),t},update:function(){var e=t(),n=s.getClasses(e);i.productData.removeClass(function(e,t){return t.split(/\s+/).filter(function(e){return 0===e.indexOf("bk_")&&!n.includes(e)}).join(" ")}),i.productData.addClass(n),o.handleEnabledFields(e)}};s.init();var c=a("#yith-wcbk-booking-costs-table"),d=c.find("tr.yith-wcbk-costs-default-row").first(),e=a("#yith-wcbk-costs-add-range"),l=a("#"+c.data("fields-container-id")),r=l.find(".yith-wcbk-admin-input-range"),u=l.find(".yith-wcbk-number-range"),p=l.find(".yith-wcbk-month-range-select"),_=l.find(".yith-wcbk-week-range-select"),h=l.find(".yith-wcbk-day-range-select");c.on("change","select.yith-wcbk-costs-range-type-select",function(e){var t,n,i=a(e.target),o=i.closest("tr"),e=o.find("td.yith-wcbk-costs-from"),o=o.find("td.yith-wcbk-costs-to"),i=i.val();switch(i){case"custom":t=r.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker(),n=r.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker();break;case"month":t=p.clone(),n=p.clone();break;case"week":t=_.clone(),n=_.clone();break;case"day":t=h.clone(),n=h.clone();break;case"time":break;default:t=u.clone(),n=u.clone()}"time"===i?(t.find("input").attr("name","_yith_booking_costs_range[from][]"),n.find("input").attr("name","_yith_booking_costs_range[to][]")):(t.attr("name","_yith_booking_costs_range[from][]"),n.attr("name","_yith_booking_costs_range[to][]")),e.html(t),o.html(n)}).on("click",".yith-wcbk-delete",function(e){a(e.target).closest("tr").remove()}).find("tbody").sortable({items:"tr",cursor:"move",handle:".yith-wcbk-anchor",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,opacity:.65,helper:function(e,t){var n=t.children(),t=t.clone();return t.children().each(function(e){a(this).width(n.eq(e).width())}),t}}),e.on("click",function(){var e=d.clone().removeClass("yith-wcbk-costs-default-row");c.append(e),e.find("select.yith-wcbk-costs-range-type-select").trigger("change")}),a(".yith-wcbk-google-maps-places-autocomplete").each(function(){"undefined"!=typeof google&&"undefined"!=typeof google.maps&&"undefined"!=typeof google.maps.places&&"undefined"!=typeof google.maps.places.Autocomplete?new google.maps.places.Autocomplete(this):console.error("Google Maps Javascript API error while using Autocomplete. Probably other plugins (or your theme) include Google Maps Javascript API without support to the Places library")}),a(".yith-wcbk-product-sync-imported-calendars-table").on("click",".insert",function(e){e.preventDefault();var t,n=a(e.target),i=n.data("row"),e=n.closest(".yith-wcbk-product-sync-imported-calendars-table"),n=e.find("tbody");e.data("last-index")?t=e.data("last-index")+1:(t=n.find("tr").length||0,t+=1),e.data("last-index",t),i=i.replace(new RegExp("{{INDEX}}","g"),t),n.append(a(i))}).on("click",".delete",function(e){e.preventDefault(),a(e.target).closest("tr").remove()});e=function(){var e,t=i.bookingDurationUnit.val(),n=i.bookingDuration.val(),n=n<2?(e=bk.i18n_durations[t].singular.replace("%s",n),bk.i18n_durations[t].singular_qty.replace("%s",n)):(e=bk.i18n_durations[t].plural.replace("%s",n),bk.i18n_durations[t].plural_qty.replace("%s",n)),t=bk.i18n_durations[t].plural_unit;a(".yith-wcbk-product-metabox-dynamic-duration").html(e),a(".yith-wcbk-product-metabox-dynamic-duration-qty").html(n),a(".yith-wcbk-product-metabox-dynamic-duration-unit").html(t)};a(document).on("change","#_yith_booking_duration, #_yith_booking_duration_unit",e),a(document).on("yith_wcbk_product_metabox_dynamic_durations",e),e();var b={list:a("#yith-wcbk-extra-costs__list"),customExtraCosts:!1,lastIndex:1,init:function(){this._initParams(),a("#yith-wcbk-extra-costs__new-extra-cost").on("click",this.addExtraCost),a(document).on("click",".yith-wcbk-extra-cost__delete",this.deleteExtraCost)},_initParams:function(){this.customExtraCosts=this.list.find(".yith-wcbk-extra-cost--custom"),this.lastIndex=this.customExtraCosts.length||0},nextIndex:function(){return++this.lastIndex},addExtraCost:function(e){e.preventDefault();var t=a(e.target).data("template"),e=b.nextIndex(),t=t.replace(new RegExp("{{INDEX}}","g"),e),t=a(t);b.list.append(t),t.find(".yith-wcbk-extra-cost__name").first().focus()},deleteExtraCost:function(e){a(e.target).closest(".yith-wcbk-extra-cost").remove()}};b.init();var y={expandCollapseButton:a(".yith-wcbk-people-types__expand-collapse"),list:a("#yith-wcbk-people-types__list"),init:function(){this.expandCollapseButton.on("click",this.expandCollapseAll)},expandCollapseAll:function(e){var t=a(e.target).closest(".yith-wcbk-people-types__expand-collapse"),e=y.list;t.is(".yith-wcbk-people-types__expand-collapse--collapse")?(t.removeClass("yith-wcbk-people-types__expand-collapse--collapse"),e.find(".yith-wcbk-settings-section-box:not(.yith-wcbk-settings-section-box--closed) .yith-wcbk-settings-section-box__toggle").click()):(t.addClass("yith-wcbk-people-types__expand-collapse--collapse"),e.find(".yith-wcbk-settings-section-box.yith-wcbk-settings-section-box--closed .yith-wcbk-settings-section-box__toggle").click())}};y.init()});