(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(t,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}var i=wp.components,a=i.Button,c=i.ComboboxControl,l=wp.element,s=l.Component,u=l.Fragment,p=function(i){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}(y,i);var l,s,p,f,m=(p=y,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var t,n=o(p);if(f){var r=o(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(this,t)});function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=m.call(this,e)).state={items:[],isBusy:!1},t.fetchItems(),t}return l=y,s=[{key:"hasMeta",value:function(){return this.props.metaFields&&this.props.metaFields.length}},{key:"fetchItems",value:function(){var e=this,n=[];if(this.props.relatedItems&&this.props.relatedItems.length)for(var r=0;r<this.props.relatedItems.length;r++)n.push(this.props.relatedItems[r].related_id);window.wp.ajax.send("jet_engine_relations_get_type_items",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,existing:n,objectType:this.props.controlObjectType,object:this.props.controlObjectName},success:function(n){var r;e.setState({items:(r=n,function(e){if(Array.isArray(e))return t(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})},error:function(e,t,n){e.message?alert(e.message):alert(n)}})}},{key:"render",value:function(){var e=this;return wp.element.createElement(u,null,0<this.state.items.length&&wp.element.createElement(u,null,wp.element.createElement(c,{value:this.state.relatedID,onChange:function(t){e.setState({relatedID:t})},label:this.props.labels.select,options:this.state.items}),wp.element.createElement(a,{isPrimary:!0,isBusy:this.state.isBusy,disabled:!this.state.relatedID,onClick:function(){e.setState({isBusy:!0}),e.props.onChange(e.state.relatedID)}},this.props.labels.connectButton)))}}],s&&n(l.prototype,s),Object.defineProperty(l,"prototype",{writable:!1}),y}(s);const f=p;function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===m(o)?o:String(o)),r)}var o}function b(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var o=j(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O(e)}(this,n)}}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var g=wp.components.Button,S=wp.blockEditor,E=S.MediaUpload,P=S.MediaUploadCheck,_=wp.element,C=_.Component,D=_.Fragment,T=window.lodash,R=T.assign,k=T.castArray,I=function(e){h(n,e);var t=w(n);function n(e){var r;return y(this,n),(r=t.call(this,e)).frame=wp.media({multiple:!1}),r.openModal=r.openModal.bind(O(r)),r.onOpen=r.onOpen.bind(O(r)),r.onSelect=r.onSelect.bind(O(r)),r.onUpdate=r.onUpdate.bind(O(r)),r.onClose=r.onClose.bind(O(r)),r.frame.on("select",r.onSelect),r.frame.on("update",r.onUpdate),r.frame.on("open",r.onOpen),r.frame.on("close",r.onClose),r}return b(n,[{key:"onSelect",value:function(){var e=this.frame.state().get("selection").toJSON();this.props.onSelect(e[0])}},{key:"onUpdate",value:function(e){var t=this.frame.state(),n=e||t.get("selection");n&&n.models.length&&this.props.onSelect(n.models[0].toJSON())}},{key:"onOpen",value:function(){if(this.updateCollection(),this.props.value){var e=this.frame.state().get("selection");k(this.props.value).forEach((function(t){e.add(wp.media.attachment(t))}))}}},{key:"onClose",value:function(){this.props.onClose&&this.props.onClose()}},{key:"updateCollection",value:function(){var e=this.frame.content.get();if(e&&e.collection){var t=e.collection;t.toArray().forEach((function(e){return e.trigger("destroy",e)})),t.mirroring._hasMore=!0,t.more()}}},{key:"openModal",value:function(){this.frame.open()}},{key:"render",value:function(){return this.props.render({open:this.openModal})}},{key:"componentWillUnmount",value:function(){this.frame.remove()}}]),n}(C);const x=function(e){h(n,e);var t=w(n);function n(e){var r;return y(this,n),(r=t.call(this,e)).state={value:r.props.value},r}return b(n,[{key:"componentDidMount",value:function(){var e=!1;switch(this.props.value_format){case"both":this.props.value&&this.props.value.url&&this.setState({previewURL:this.props.value.url});break;case"url":this.props.value&&this.setState({previewURL:this.props.value});break;default:this.props.value&&(e=this.props.value)}e&&this.fetchImg(e)}},{key:"mediaUploadRender",value:function(e){var t=this;return wp.element.createElement("div",{style:{display:"flex",paddingTop:"5px",paddingBottom:"15px"}},wp.element.createElement(g,{onClick:e,className:"is-nested-modal-trigger",isSecondary:!0,isSmall:!0},"Select or upload image"),this.state.value&&wp.element.createElement(g,{onClick:function(){t.setState((function(e){var n=R({},e,{value:null,previewURL:null});return t.props.onChange(n.value),n}))},isDestructive:!0,isSmall:!0,style:{marginLeft:"5px"}},"Reset"))}},{key:"mediaUploadOnSelect",value:function(e){var t=this;this.setState((function(n){var r={};switch(t.props.value_format){case"both":r=R({},n,{value:{id:e.id,url:e.url}});break;case"url":r=R({},n,{value:e.url});break;default:r=R({},n,{value:e.id})}return t.props.onChange(r.value),r})),this.setState({previewURL:e.url})}},{key:"fetchImg",value:function(e){var t=this;wp.apiFetch({method:"get",path:"/wp/v2/media/"+e}).then((function(e){t.setState({previewURL:e.media_details.sizes.thumbnail.source_url})}))}},{key:"render",value:function(){var e=this;return wp.element.createElement(D,null,wp.element.createElement("div",{style:{paddingBottom:"10px"}},wp.element.createElement("b",null,this.props.label)),this.state.previewURL&&wp.element.createElement("img",{src:this.state.previewURL,width:"150px",height:"auto"}),wp.element.createElement(P,{fallback:wp.element.createElement(I,{onSelect:function(t){e.mediaUploadOnSelect(t)},value:this.state.value,render:function(t){var n=t.open;return e.mediaUploadRender(n)}})},wp.element.createElement(E,{onSelect:function(t){e.mediaUploadOnSelect(t)},value:this.state.value,render:function(t){var n=t.open;return e.mediaUploadRender(n)}})))}}]),n}(C);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==B(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===B(o)?o:String(o)),r)}var o}function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}var L=wp.components,U=L.BaseControl,z=L.CheckboxControl,J=wp.element,A=J.Component;J.Fragment,window.lodash.assign;const G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=F(r);if(o){var n=F(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={value:t.props.value||[]},t}return t=a,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.help,o=t.options,i=t.layout,a=t.onChange;return wp.element.createElement(U,{label:n,help:r},wp.element.createElement("div",{className:"je-checkbox-group-"+i},o.map((function(t,n){return wp.element.createElement(z,{label:t.label,key:"check_"+t.value+n,checked:e.state.value.includes(t.value),onChange:function(){var n=e.state.value;n.includes(t.value)?n.splice(n.indexOf(t.value),1):n.push(t.value),e.setState({value:n},(function(){a(e.state.value)}))}})}))))}}])&&M(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(A);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q(r.key),r)}}function q(e){var t=function(e,t){if("object"!==V(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===V(t)?t:String(t)}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}var Q=wp.components,X=(Q.Button,Q.TextControl),Y=Q.TextareaControl,Z=Q.RadioControl,ee=Q.SelectControl,te=wp.element,ne=te.Component,re=te.Fragment,oe=window.lodash.assign;const ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=K(r);if(o){var n=K(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).props.values?t.state=oe({},t.props.values):t.state={},t}return t=a,(n=[{key:"onChange",value:function(e,t){var n=this;this.setState((function(r){var o=oe({},r,function(e,t,n){return(t=q(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,t));return n.props.onChange(o),o}))}},{key:"fieldTemplate",value:function(e){var t=this,n={key:"field_"+e.type+e.name,label:e.title,help:e.description?wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.description}}):"",value:this.state[e.name],onChange:function(n){t.onChange(e.name,n)}},r=oe({},e);r.class&&(r.className=r.class,delete r.class);var o,i=e.type;switch("text"===i&&e.input_type&&(i=e.input_type),-1!==["checkbox","radio"].indexOf(e.type)&&(o=e.layout||"vertical"),i){case"select":return wp.element.createElement(ee,H({},n,{options:e.options,multiple:e.multiple}));case"radio":return parseInt(n.value,10)==n.value?n.selected=parseInt(n.value,10):n.selected=n.value,delete n.value,wp.element.createElement(Z,H({className:"je-radio-group-"+o},n,{options:e.options}));case"checkbox":return wp.element.createElement(G,H({},n,{options:e.options,layout:o}));case"media":return e.multi_upload?wp.element.createElement("p",null,wp.element.createElement("i",null,"Gallery field type is not supported")):wp.element.createElement(x,H({},n,e));case"date":return wp.element.createElement(X,H({},n,{type:"date"}));case"time":return wp.element.createElement(X,H({},n,{type:"time"}));case"textarea":case"wysiwyg":return wp.element.createElement(Y,n);case"datetime-local":return wp.element.createElement(X,H({},n,{type:"datetime-local"}));case"switcher":case"iconpicker":case"repeater":case"colorpicker":case"posts":case"html":return wp.element.createElement("p",null,wp.element.createElement("i",null,i+" field type is not supported"));default:return wp.element.createElement(X,n)}}},{key:"render",value:function(){var e=this;return wp.element.createElement(re,null,this.props.fields.map((function(t){return e.fieldTemplate(t)})))}}])&&W(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ne);function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ae(o)?o:String(o)),r)}var o}function le(e,t){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},le(e,t)}function se(e){return se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},se(e)}var ue=wp.components,pe=ue.Button,fe=(ue.ComboboxControl,wp.element),me=fe.Component,ye=fe.Fragment,de=window.lodash.assign;const be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=se(r);if(o){var n=se(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={item:{},isBusy:!1},t}return t=a,(n=[{key:"createItem",value:function(){var e=this;window.wp.ajax.send("jet_engine_relations_create_item_of_type",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,item:this.state.item},success:function(t){e.props.onChange(t.itemID),e.setState({isBusy:!1})},error:function(t,n,r){e.setState({isBusy:!1}),t?alert(t):alert(r)}})}},{key:"render",value:function(){var e=this;return wp.element.createElement(ye,null,wp.element.createElement(ie,{fields:this.props.createFields,onChange:function(t){e.setState({item:de({},t)})}}),wp.element.createElement(pe,{isPrimary:!0,isBusy:this.state.isBusy,className:"jet-engine-rels__create-item",onClick:function(){e.setState({isBusy:!0}),e.createItem()}},this.props.labels.createButton))}}])&&ce(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(me);function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==he(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===he(o)?o:String(o)),r)}var o}function we(e,t){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},we(e,t)}function Oe(e){return Oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Oe(e)}var je=wp.components,ge=je.Button,Se=(je.TextControl,wp.element),Ee=Se.Component,Pe=Se.Fragment,_e=window.lodash.assign;const Ce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&we(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Oe(r);if(o){var n=Oe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n=(t=i.call(this,e)).props.value||{};return t.state={metaData:_e({},n),isBusy:!1,done:!1},t.savedTimeout=null,t}return t=a,(n=[{key:"saveMeta",value:function(){var e=this;window.wp.ajax.send("jet_engine_relations_save_relation_meta",{type:"POST",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:this.props.relatedObjectID,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,currentObjectID:this.props.currentObjectID,isParentProcessed:this.props.isParentProcessed,meta:this.state.metaData},success:function(t){e.setState({isBusy:!1,done:!0}),e.savedTimeout=setTimeout((function(){e.setState({done:!1})}),2e3),e.props.onUpdate()},error:function(t,n,r){t?alert(t):alert(r),e.setState({isBusy:!1,done:!1})}})}},{key:"render",value:function(){var e=this;return wp.element.createElement(Pe,null,wp.element.createElement(ie,{fields:this.props.metaFields,values:this.state.metaData,onChange:function(t){e.setState({metaData:_e({},t)})}}),wp.element.createElement("div",{className:"jet-engine-rels-popup__footer"},wp.element.createElement(ge,{isPrimary:!0,isBusy:this.state.isBusy,onClick:function(){e.setState({isBusy:!0}),e.savedTimeout&&(clearTimeout(e.savedTimeout),e.savedTimeout=null),e.saveMeta()}},"Save Meta Data"),this.state.isBusy&&wp.element.createElement("span",{style:{marginLeft:"10px"}},"Saving..."),!this.state.isBusy&&this.state.done&&wp.element.createElement("span",{style:{marginLeft:"10px",color:"green"}},"Saved!")))}}])&&ve(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee);function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Te(){return Te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Te.apply(this,arguments)}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==De(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===De(o)?o:String(o)),r)}var o}function ke(e,t){return ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ke(e,t)}function Ie(e){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ie(e)}var xe=wp.components,Be=xe.Modal,Me=(xe.Button,wp.element),Ne=Me.Component;Me.Fragment;const Fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ie(r);if(o){var n=Ie(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={relatedObjectID:!1,relatedList:[],isBusy:!1},t}return t=a,(n=[{key:"processRelation",value:function(e){var t=this;window.wp.ajax.send("jet_engine_relations_update_relation_items",{type:"POST",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:e,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,currentObjectID:this.props.currentObjectID},success:function(n){t.hasMetaFields()?t.setState({relatedObjectID:e,relatedList:n.related_list}):t.props.onComplete(n.related_list),t.setState({isBusy:!1})},error:function(e,n,r){t.setState({isBusy:!1}),e?alert(e):alert(r)}})}},{key:"hasMetaFields",value:function(){return this.props.metaFields&&0<this.props.metaFields.length}},{key:"showMetaFields",value:function(){return this.state.relatedObjectID&&this.hasMetaFields()}},{key:"modalTitle",value:function(){return this.showMetaFields()?"Edit Meta Fields":this.props.title}},{key:"render",value:function(){var e=this,t={width:"760px",maxWidth:"80vw"};this.state.isBusy&&(t.opacity="0.9");var n=["jet-engine-rels-modal"];return this.showMetaFields()&&n.push("has-footer"),wp.element.createElement(Be,{title:this.modalTitle(),style:t,className:n.join(" "),onRequestClose:function(t){t.target.classList.contains("is-nested-modal-trigger")||e.props.onClose(e.state.relatedList)}},"create"===this.props.type&&!this.state.relatedObjectID&&wp.element.createElement(be,Te({},this.props,{onChange:function(t){e.setState({isBusy:!0}),e.processRelation(t)}})),"connect"===this.props.type&&!this.state.relatedObjectID&&wp.element.createElement(f,Te({},this.props,{onChange:function(t){e.setState({isBusy:!0}),e.processRelation(t)}})),this.showMetaFields()&&wp.element.createElement(Ce,Te({},this.props,{relatedObjectID:this.state.relatedObjectID,onUpdate:function(){e.props.onComplete(e.state.relatedList)}})))}}])&&Re(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ne);var Le=wp.components,Ue=Le.SVG,ze=Le.Path;const Je=wp.element.createElement(Ue,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},wp.element.createElement(ze,{d:"M10 6c3.9 0 7-.9 7-2s-3.1-2-7-2-7 .9-7 2 3.1 2 7 2zm0 9c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2v-3c0 1.1-3.1 2-7 2zm0-4c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2V9c0 1.1-3.1 2-7 2zm0-4c-3.9 0-7-.9-7-2v3c0 1.1 3.1 2 7 2s7-.9 7-2V5c0 1.1-3.1 2-7 2z"}));function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ge.apply(this,arguments)}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Ae(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ae(o)?o:String(o)),r)}var o}function He(e,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},He(e,t)}function We(e){return We=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},We(e)}var qe=wp.components,$e=qe.Modal,Ke=qe.Button,Qe=wp.element,Xe=Qe.Component,Ye=Qe.Fragment,Ze=window.lodash.assign;const et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&He(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=We(r);if(o){var n=We(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={showModal:!1,dataLoaded:!1,metaData:{}},t}return t=a,(n=[{key:"hasMeta",value:function(){return this.props.metaFields&&0<this.props.metaFields.length}},{key:"fetchData",value:function(){var e=this;window.wp.ajax.send("jet_engine_relations_get_related_item_meta",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:this.props.relatedObjectID,relatedObjectType:this.props.controlObjectType,relatedObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,currentObjectID:this.props.currentObjectID},success:function(t){t&&e.setState({metaData:Ze({},t)}),e.setState({dataLoaded:!0})},error:function(e,t,n){e?alert(e):alert(n)}})}},{key:"render",value:function(){var e=this,t=["jet-engine-rels-modal"];return this.state.dataLoaded&&t.push("has-footer"),wp.element.createElement(Ye,null,wp.element.createElement(Ke,{isSecondary:!0,isSmall:!0,icon:Je,onClick:function(){e.fetchData(),e.setState({showModal:!0})}},"Edit Meta"),this.state.showModal&&wp.element.createElement($e,{title:"Edit Meta",style:{width:"760px",maxWidth:"80vw"},className:t.join(" "),onRequestClose:function(t){t.target.classList.contains("is-nested-modal-trigger")||e.setState({showModal:!1,metaData:{},dataLoaded:!1})}},this.state.dataLoaded&&wp.element.createElement(Ce,Ge({},this.props,{value:this.state.metaData,onUpdate:function(){e.setState()}})),!this.state.dataLoaded&&wp.element.createElement("div",null,"Loading existing meta data...")))}}])&&Ve(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Xe);var tt=wp.components,nt=tt.SVG,rt=tt.Path;const ot=wp.element.createElement(nt,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},wp.element.createElement("rect",{x:"0",fill:"none",width:"20",height:"20"}),wp.element.createElement(rt,{d:"M4 5H2v13h10v-2H4V5zm13.9-1.6l-1.3-1.3c-.4-.4-1.1-.5-1.6-.1l-1 1H5v12h9V9l4-4c.4-.5.3-1.2-.1-1.6zm-5.7 6l-2.5.9.9-2.5L15 3.4 16.6 5l-4.4 4.4z"}));var it=wp.components,at=it.SVG,ct=it.Path;const lt=wp.element.createElement(at,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},wp.element.createElement("rect",{x:"0",fill:"none",width:"20",height:"20"}),wp.element.createElement(ct,{d:"M18.3 9.5C15 4.9 8.5 3.8 3.9 7.2c-1.2.9-2.2 2.1-3 3.4.2.4.5.8.8 1.2 3.3 4.6 9.6 5.6 14.2 2.4.9-.7 1.7-1.4 2.4-2.4.3-.4.5-.8.8-1.2-.3-.4-.5-.8-.8-1.1zm-8.2-2.3c.5-.5 1.3-.5 1.8 0s.5 1.3 0 1.8-1.3.5-1.8 0-.5-1.3 0-1.8zm-.1 7.7c-3.1 0-6-1.6-7.7-4.2C3.5 9 5.1 7.8 7 7.2c-.7.8-1 1.7-1 2.7 0 2.2 1.7 4.1 4 4.1 2.2 0 4.1-1.7 4.1-4v-.1c0-1-.4-2-1.1-2.7 1.9.6 3.5 1.8 4.7 3.5-1.7 2.6-4.6 4.2-7.7 4.2z"}));var st=wp.components,ut=st.SVG,pt=st.Path;const ft=wp.element.createElement(ut,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},wp.element.createElement("rect",{x:"0",fill:"none",width:"20",height:"20"}),wp.element.createElement(pt,{d:"M17.74 2.26c1.68 1.69 1.68 4.41 0 6.1l-1.53 1.52c-.32.33-.69.58-1.08.77L13 10l1.69-1.64.76-.77.76-.76c.84-.84.84-2.2 0-3.04-.84-.85-2.2-.85-3.04 0l-.77.76-.76.76L10 7l-.65-2.14c.19-.38.44-.75.77-1.07l1.52-1.53c1.69-1.68 4.42-1.68 6.1 0zM2 4l8 6-6-8zm4-2l4 8-2-8H6zM2 6l8 4-8-2V6zm7.36 7.69L10 13l.74 2.35-1.38 1.39c-1.69 1.68-4.41 1.68-6.1 0-1.68-1.68-1.68-4.42 0-6.1l1.39-1.38L7 10l-.69.64-1.52 1.53c-.85.84-.85 2.2 0 3.04.84.85 2.2.85 3.04 0zM18 16l-8-6 6 8zm-4 2l-4-8 2 8h2zm4-4l-8-4 8 2v2z"}));var mt=wp.components,yt=mt.SVG,dt=mt.Path;const bt=wp.element.createElement(yt,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},wp.element.createElement(dt,{d:"M12 4h3c.6 0 1 .4 1 1v1H3V5c0-.6.5-1 1-1h3c.2-1.1 1.3-2 2.5-2s2.3.9 2.5 2zM8 4h3c-.2-.6-.9-1-1.5-1S8.2 3.4 8 4zM4 7h11l-.9 10.1c0 .5-.5.9-1 .9H5.9c-.5 0-.9-.4-1-.9L4 7z"}));function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ht(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ht(o)?o:String(o)),r)}var o}function wt(e,t){return wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wt(e,t)}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}var jt=wp.components,gt=jt.Button,St=jt.Popover,Et=wp.element,Pt=Et.Component;Et.Fragment;const _t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ot(r);if(o){var n=Ot(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={isTrash:!1,isDisconnect:!1},t}return t=a,(n=[{key:"processDisconnect",value:function(){var e=this;window.wp.ajax.send("jet_engine_relations_disconnect_relation_items",{type:"POST",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,relatedObjectID:this.props.relatedObjectID,relatedObjectType:this.props.relatedObjectType,relatedObjectName:this.props.relatedObjectName,currentObjectID:this.props.currentObjectID,isParentProcessed:this.props.isParentProcessed,isTrash:this.state.isTrash},success:function(t){e.cancelDisconnect(),e.props.onUpdate(t.related_list)},error:function(t,n,r){e.cancelDisconnect(),t?alert(t):alert(r)}})}},{key:"cancelDisconnect",value:function(){this.setState({isTrash:!1,isDisconnect:!1})}},{key:"confirmPopover",value:function(e){var t=this;return e=e||window.JetEngineRelationsCommon.i18n.confirmText,wp.element.createElement(St,{position:"top center",noArrow:!1,onFocusOutside:function(){t.cancelDisconnect()}},wp.element.createElement("div",{style:{width:"100px",display:"flex",padding:"3px",justifyContent:"center",textAlign:"center",flexWrap:"wrap"}},e,wp.element.createElement("a",{href:"#",style:{margin:"0 4px"},onClick:function(e){e.preventDefault(),e.stopPropagation(),t.processDisconnect()}},window.JetEngineRelationsCommon.i18n.yes),wp.element.createElement("a",{href:"#",style:{margin:"0 4px"},onClick:function(e){e.preventDefault(),e.stopPropagation(),t.cancelDisconnect()}},window.JetEngineRelationsCommon.i18n.no)))}},{key:"render",value:function(){var e=this;return wp.element.createElement("div",{className:"jet-engine-rels__actions-list"},this.props.actions.edit&&wp.element.createElement(gt,{isSecondary:!0,isSmall:!0,icon:ot,onClick:function(){window.open(e.props.actions.edit,"_blank").focus()}},window.JetEngineRelationsCommon.i18n.edit),this.props.actions.view&&wp.element.createElement(gt,{isSecondary:!0,isSmall:!0,icon:lt,onClick:function(){window.open(e.props.actions.view,"_blank").focus()}},window.JetEngineRelationsCommon.i18n.view),this.props.actions.disconnect&&wp.element.createElement(gt,{isSecondary:!0,isDestructive:!0,isSmall:!0,icon:ft,onClick:function(){e.setState({isTrash:!1,isDisconnect:!0})}},window.JetEngineRelationsCommon.i18n.disconnect,this.state.isDisconnect&&!this.state.isTrash&&this.confirmPopover()),this.props.actions.trash&&wp.element.createElement(gt,{isSecondary:!0,isDestructive:!0,isSmall:!0,icon:bt,onClick:function(){e.setState({isTrash:!0,isDisconnect:!0})}},window.JetEngineRelationsCommon.i18n.deleteItem,this.state.isDisconnect&&this.state.isTrash&&this.confirmPopover(window.JetEngineRelationsCommon.i18n.confirmDelete)))}}])&&vt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Pt);function Ct(e){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ct(e)}function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dt.apply(this,arguments)}function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Ct(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ct(o)?o:String(o)),r)}var o}function Rt(e,t){return Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rt(e,t)}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kt(e)}wp.components.Button;var It=wp.element,xt=It.Component;It.Fragment;const Bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kt(r);if(o){var n=kt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ct(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"hasMeta",value:function(){return this.props.metaFields&&0<this.props.metaFields.length}},{key:"render",value:function(){var e=this,t=this.props.items.map((function(t){var n=t.columns.map((function(e,t){return wp.element.createElement("td",{key:"col_"+t,dangerouslySetInnerHTML:{__html:e}})}));return wp.element.createElement("tr",{key:"row_"+t._ID},n,e.hasMeta()&&wp.element.createElement("td",{className:"rel-meta"},wp.element.createElement(et,Dt({},e.props,{relatedObjectID:t.related_id}))),wp.element.createElement("td",null,wp.element.createElement(_t,{actions:t.actions,relID:e.props.relID,relatedObjectID:t.related_id,relatedObjectType:e.props.controlObjectType,relatedObjectName:e.props.controlObjectName,currentObjectID:e.props.currentObjectID,isParentProcessed:e.props.isParentProcessed,onUpdate:function(t){e.props.onUpdate(t)}})))})),n=this.props.columns.map((function(e){return wp.element.createElement("th",{key:"rel-heading-"+e.key,className:"rel-"+e.key},e.label)}));return wp.element.createElement("div",{className:"jet-engine-rels__table-wrap"},wp.element.createElement("table",{className:"wp-list-table widefat fixed striped table-view-list jet-engine-rels__table"},wp.element.createElement("thead",null,wp.element.createElement("tr",null,n)),wp.element.createElement("tbody",null,0<this.props.items.length&&t,!this.props.items.length&&wp.element.createElement("tr",null,wp.element.createElement("td",{colSpan:this.props.columns.length},"--"))),wp.element.createElement("tfoot",null,wp.element.createElement("tr",null,n))))}}])&&Tt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(xt);function Mt(e){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mt(e)}function Nt(){return Nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nt.apply(this,arguments)}function Ft(e){return function(e){if(Array.isArray(e))return Lt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Mt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Mt(o)?o:String(o)),r)}var o}function zt(e,t){return zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zt(e,t)}function Jt(e){return Jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Jt(e)}for(var At=wp.components,Gt=At.Button,Vt=At.ButtonGroup,Ht=wp.element,Wt=Ht.render,qt=Ht.Component,$t=(Ht.Fragment,function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Jt(r);if(o){var n=Jt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Mt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={connectNew:!1,createNew:!1,relatedID:null,relatedItems:[],allowedOptions:[]},t.fetchItems(),t}return t=a,(n=[{key:"fetchItems",value:function(){var e=this;window.wp.ajax.send("jet_engine_relations_get_related_items",{type:"GET",data:{_nonce:window.JetEngineRelationsCommon._nonce,relID:this.props.relID,objectType:this.props.controlObjectType,object:this.props.controlObjectName,currentObjectID:this.props.currentObjectID,isParentProcessed:this.props.isParentProcessed},success:function(t){e.setState({relatedItems:Ft(t)})},error:function(e,t,n){e?alert(e):alert(n)}})}},{key:"buttonLabel",value:function(e){switch(e=e||"connect"){case"connect":return this.props.labels.connectButton;case"create":return this.props.labels.createButton}}},{key:"modalTitle",value:function(){return this.state.connectNew?this.buttonLabel("connect"):this.state.createNew?this.buttonLabel("create"):null}},{key:"closeModal",value:function(e){this.setState({createNew:!1,connectNew:!1}),e&&e.length&&this.setState({relatedItems:Ft(e)})}},{key:"canCreate",value:function(){return this.props.createFields&&0<this.props.createFields.length}},{key:"render",value:function(){var e=this;return wp.element.createElement("div",{className:"jet-engine-rels"},(this.state.connectNew||this.state.createNew)&&wp.element.createElement(Fe,Nt({},this.props,{title:this.modalTitle(),relatedItems:this.state.relatedItems,type:this.state.connectNew?"connect":"create",onClose:function(t){t=t||!1,e.closeModal(t)},onComplete:function(t){t&&t.length?e.setState({relatedItems:Ft(t)}):e.setState({relatedItems:[]}),e.closeModal()}})),wp.element.createElement(Vt,{style:{display:"flex",gap:"10px"}},this.canCreate()&&wp.element.createElement(Gt,{isSecondary:!0,onClick:function(){e.setState({createNew:!0,connectNew:!1})}},this.buttonLabel("create")),wp.element.createElement(Gt,{isSecondary:!0,onClick:function(){e.setState({createNew:!1,connectNew:!0})}},this.buttonLabel("connect"))),wp.element.createElement(Bt,{items:this.state.relatedItems,columns:this.props.tableColumns,metaFields:this.props.metaFields,relID:this.props.relID,currentObjectID:this.props.currentObjectID,controlObjectType:this.props.controlObjectType,controlObjectName:this.props.controlObjectName,isParentProcessed:this.props.isParentProcessed,onUpdate:function(t){e.setState({relatedItems:Ft(t)})}}))}}])&&Ut(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(qt)),Kt=0;Kt<window.JetEngineRelationsControls.length;Kt++){var Qt=window.JetEngineRelationsControls[Kt],Xt=document.getElementById(Qt.relEl);Xt&&Wt(wp.element.createElement($t,{relID:Qt.relID,metaFields:Qt.metaFields,labels:Qt.labels,tableColumns:Qt.tableColumns,currentObjectID:window.JetEngineCurrentObjectID,controlObjectType:Qt.objectType,controlObjectName:Qt.object,isParentProcessed:Qt.isParentProcessed,createFields:Qt.createFields}),Xt)}})();